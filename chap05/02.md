# 반정규화 (De-Normalization)

### 1. 반정규화란?
    데이터의 조회 성능을 향상시키기 위해 데이터의 중복을 허용하거나 데이터를 그룹핑하는 과정이다.
* 데이터 조회 성능은 향상될 수 있으나 입력, 수정, 삭제 성능은 저하될 수 있으며 데이터 정합성 이슈가 발생할 수 있어 주의가 필요하다.
* 반정규화의 과정은 정규화가 끝난 후 거치게 되며 정규화와 마찬가지로 일정한 룰이 존재한다.

### 2. 테이블 반정규화

1. 테이블 병합 (JOIN 이 많이 필요한 경우) 
   - 1:1 관계 테이블 병합
   - 1:M 관계 테이블 병합
     - 1에 해당하는 엔터티의 속성 개수가 많을 경우 병합했을때 중복 데이터가 많아지므로 테이블 병합이 적절하지 못하다.
2. 테이블 분할 
   - 테이블 수직 분할
     - 엔터티의 일부 속성을 별도의 엔터티로 분할 (1:1 관계 성립)
     - 자주 사용하는 속성이 아니거나 대부분의 인스턴스가 해당 속성값을 NULL 로 갖고 있을 때 고려
   - 테이블 수평 분할
     - 엔터티의 인스턴스를 특정 기준으로 별도의 엔터티로 분할 (파티셔닝)
     - 예시 : 파티션 기능을 사용하여 주문일자에 따라 데이터를 물리적으로 분리 (2021, 2022, 2023 등)
3. 테이블 추가
   - 중복 테이블 추가
     - 데이터 중복을 감안하더라도 성능상 반드시 필요하다고 판단되는 경우 별도의 엔터티를 추가한다.
   - 통계 테이블 추가
     - 예시 : 주문데이터를 이용하여 월매출 테이블에 통계치를 미리 계산하여 저장
   - 이력 테이블 추가
     - 예시 : 상품가격 이력 테이블에서 과거의 상품가격에 대한 데이터를 관리
   - 부분 테이블 추가
     - 예시 : 회원 대상 메일 발송건이 다량으로 생기는 경우 메일 발송에 필요한 정보만 부분 테이블로 생성

### 3. 컬럼 반정규화
   - 중복 컬럼 추가
     - 업무 프로세스상 JOIN이 필요한 경우가 많아 컬럼을 추가하는 것이 성능 측면에서 유리할 경우 고려한다.
   - 파생 컬럼 추가
     - 프로세스 수행 시 부하가 염려되는 계산값을 미리 컬럼으로 추가하여 보관하는 방식으로 상품의 재고나 프로모션 적용 할인가 등이 이에 해당할 수 있다.
   - 이력 테이블 컬럼 추가
     - 대량의 이력 테이블을 조회할 때 속도가 느려질 것을 대비하여 조회 기준이 될 것으로 판단되는 컬럼을 미리 추가해 놓는 방식이다. 최신 데이터 여부 등이 이에 해당할 수 있다.

### 4. 관계 반정규화 (중복관계 추가)
    업무 프로세스상 JOIN이 필요한 경우가 많아 중복 관계를 추가하는 것이 성능 측면에서 유리할 경우 고려한다.
